define("modules/clean/react/file_viewer/file_conversion/api",["require","exports","modules/clean/api_v2/user_client"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postExecuteFileAction=function(e,t,i){var n={action:{type:e},file_identifier:t};return(new r.UserApiV2Client).ns("file_conversions").rpc("execute",n,{subjectUserId:i})}})),define("modules/clean/react/file_viewer/file_conversion/decompress",["require","exports","tslib","modules/clean/react/file_viewer/file_conversion/api","react","modules/clean/react/snackbar","modules/core/i18n","modules/clean/browse_uri_interface","modules/core/uri","modules/core/browser","modules/clean/file_store/utils","modules/clean/datetime","modules/clean/react/file_viewer/file_conversion/utils"],(function(e,t,r,i,n,o,a,s,l,c,u,d,p){"use strict";function f(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,o;return r.__generator(this,(function(r){switch(r.label){case 0:m("sync",e,t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.postExecuteFileAction({".tag":"decompress"},v(e),t.id)];case 2:return(n=r.sent())&&n.path&&m("complete",e,t,n),[3,4];case 3:return o=r.sent(),p.isOverQuotaError(o)?m("overquota",e,t):m("fail",e,t),[3,4];case 4:return[2]}}))}))}function m(e,t,i,d){var p={sync:{title:a.intl.formatMessage({id:"M+MSD3",defaultMessage:"Extracting {file_name} - {time_remaining}."},{file_name:u.getFilename(t),time_remaining:h(t)}),variant:"sync",syncProgressLoop:!0,closeButtonText:a.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onCloseClick:function(){},id:"file-conversion-snackbar",useDig:!0},complete:{title:a.intl.formatMessage({id:"TZFARr",defaultMessage:"Files extracted."}),variant:"complete",id:"file-conversion-snackbar",actionButtonText:a.intl.formatMessage({id:"CPUBF2",defaultMessage:"Go to folder"}),onActionClick:function(){return(function(e,t){var r=t?t.path:"",i=s.get_browse_root(e)+l.URI.encode_parts(r);c.replace_location(i)})(i,d)},closeButtonText:a.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onCloseClick:function(){},useDig:!0},fail:{title:a.intl.formatMessage({id:"+kM7ME",defaultMessage:"Couldn't extract files."}),variant:"fail",id:"file-conversion-snackbar",actionButtonText:a.intl.formatMessage({id:"BCyGLk",defaultMessage:"Try again"}),onActionClick:function(){return f(t,i)},closeButtonText:a.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onCloseClick:function(){},useDig:!0},overquota:{title:a.intl.formatMessage({id:"lrBfJ8",defaultMessage:"Couldn't extract files because your account is over quota."}),variant:"fail",id:"file-conversion-snackbar",closeButtonText:a.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onCloseClick:function(){},useDig:!0}};o.Snackbar.update(n.default.createElement(o.Snackbar,r.__assign({},p[e])))}function v(e){return u.isBrowseFile(e)?{path:e.fq_path,".tag":"path"}:{shared_link_url:e.href?e.href:"",".tag":"shared_link_url"}}function h(e){var t=e.bytes/1e6,r=Math.ceil(t/10)+Math.ceil(t/50)+2;return r<10?"a few seconds left":d.format_time_remaining(r)}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),c=r.__importStar(c),d=r.__importStar(d),t.decompressFile=f})),define("modules/clean/react/file_viewer/file_conversion/utils",["require","exports","modules/constants/file_viewer","modules/clean/file_store/utils"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[".7z",".bz",".bz2",".cpio",".gz",".iso",".lha",".lz",".lzh",".lzma",".rar",".tar",".taz",".tbz",".tbz2",".tgz",".tlz",".txz",".tz",".xar",".xz",".z",".zip"];t.FileConversionVariant=function(){return r.FILE_CONVERSION},t.decompressMvpIsEnabled=function(){return"DECOMPRESS_MVP"===r.FILE_CONVERSION},t.canExtractFile=function(e,r){return i.isBrowseFile(e)?t.decompressMvpIsEnabled()&&n.includes(e.ext):t.decompressMvpIsEnabled()&&n.includes("."+i.getExtension(e))&&!!r&&r.canDownloadRoles.length>0},t.isOverQuotaError=function(e){return(null==e?void 0:e.error)&&"over_quota_error"===e.error[".tag"]}})),define("modules/clean/react/previews/archive/api",["require","exports","tslib","external/lodash","modules/clean/react/previews/archive/constants","modules/clean/api_v2/user_client","modules/clean/api_v2/noauth_client","modules/clean/filepath","modules/core/exception"],(function(e,t,r,i,n,o,a,s,l){"use strict";function c(e){return{name:e.name,size:void 0!==e.size?parseInt(e.size,10):void 0,isDir:e.isDir,children:e.children?(t=e.children,i.keyBy(i.values(t.map(c)),"name")):{}};var t}function u(e){var t=s.file_extension(e);if(!n.COMPRESSED_EXTENSIONS.includes(t))return!1;var r=s.filename_without_extension(e),i=s.file_extension(r);return!n.COMPRESSED_CONTAINER_EXTENSIONS.includes(i)}function d(e){return{isDir:!0,isEncrypted:!1,children:[{isDir:!1,isEncrypted:!1,name:s.filename_without_extension(e)}],name:"/",size:"0"}}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),n=r.__importStar(n),s=r.__importStar(s),l=r.__importStar(l),t.shouldMockRootArchiveEntry=u,t.generateRootArchiveEntry=d,t.fetchRootArchiveEntry=function(e){return new Promise((function(t,r){var i=function(e){var r;t({rootEntry:c(r=e),isPasswordProtected:!!r.isEncrypted})};if(u(e.filename)){var n=d(e.filename);i(n)}else{var o=new XMLHttpRequest;o.open("GET",e.url),o.withCredentials=!0,o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE)if(200===o.status){var e=o.response,t=JSON.parse(e);i(t)}else{l.reportException({err:new Error("Failed to retrieve entry tree"),tags:["archivePreviews"],severity:l.SEVERITY.NONCRITICAL}),r("Failed to retrieve entry tree")}},o.send()}}))},t.fetchArchiveFiles=function(e){var t=e.rootFile,r=e.subpathInfos,n=e.user,s=e.sharedLinkUrl,l={root_file_info:{ns_id:t.ns_id,sj_id:t.sjid,url:s},subpaths:r.map((function(e){return e.subpath})),subpath_sizes:r.some((function(e){return void 0===e.size}))?void 0:r.map((function(e){return e.size}))};return(n?(new o.UserApiV2Client).ns("previews").rpc("get_archive_files",l,{subjectUserId:n.id}):(new a.NoAuthApiV2Client).ns("previews").rpc("logged_out/get_archive_files",l,{})).then((function(e){return t=e.archive_files,i.keyBy(t,"subpath");var t}))}})),define("modules/clean/react/previews/archive/app",["require","exports","tslib","react","modules/clean/previews/util","modules/clean/loggers/file_preview_logger","modules/clean/react/file_viewer/logging","modules/clean/file_store/utils","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/constants","modules/clean/file_store/utils","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/archive_entry_watcher","modules/clean/react/previews/archive/keyboard_binding_connector","modules/clean/react/previews/archive/utils","modules/clean/react/previews/archive/view","modules/clean/web_timing_logger","modules/clean/redux/types","modules/clean/file_store/utils"],(function(e,t,r,i,n,o,a,s,l,c,u,d,p,f,m,v,h,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),s=r.__importStar(s),h=r.__importStar(h);var w=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onFetchSuccess=function(){if(t.markWebTiming(),t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadSucceeded),t.logFilePreviewTimeline(c.EventType.FilePreviewRenderSucceeded),t.props.entry){var e=m.scanEntryContents(t.props.entry);t.logArchivePreviewEvent(c.EventType.ArchivePreviewContentsScanned,e)}t.props.setRenderStatusSuccess()},t.onFetchFailure=function(){t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadFailed),t.props.onError&&t.props.onError()},t.handleEntryRowClick=function(e,r){e.preventDefault();var i=t.props.fileSubpath;if(r){var n=d.addToFileSubpath(i,r.name);d.updateFileSubpathQuery(n),t.logUserAction(r,c.UserAction.ArchiveNavigation,c.UserActionContext.PreviewContentMain)}},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setUpLogger(),this.fetchArchiveContents()},t.prototype.componentWillUnmount=function(){this.teardownLogger(),this.props.resetState(),d.updateFileSubpathQuery(null)},t.prototype.componentDidUpdate=function(e){if(g.areFilesEqual(e.rootFile,this.props.rootFile)&&e.previewUrl===this.props.previewUrl||(this.props.resetState(),this.fetchArchiveContents()),e.treeApiStatus===_.ApiClientStatus.Fetch)switch(this.props.treeApiStatus){case _.ApiClientStatus.Success:this.onFetchSuccess();break;case _.ApiClientStatus.Error:this.onFetchFailure()}},t.prototype.fetchArchiveContents=function(){if(this.logFilePreviewTimeline(c.EventType.FilePreviewSupportConfirmed),this.props.previewUrl){this.logFilePreviewTimeline(c.EventType.FilePreviewDownloadAttempted);var e=m.getPreviewUrl(this.props.previewUrl),t=s.getFilename(this.props.rootFile);this.props.fetchRootArchiveEntry({url:e,filename:t})}else this.props.onError&&this.props.onError()},t.prototype.setUpLogger=function(){this.logger&&this.teardownLogger(),this.logger=new o.FilePreviewArchiveLogger,this.logger.listenTo(l.filePreviewEventEmitter)},t.prototype.teardownLogger=function(){this.logger.unlistenTo(l.filePreviewEventEmitter),delete this.logger},t.prototype.logFilePreviewTimeline=function(e){this.props.filePreviewSession&&this.props.filePreviewSession.recordEvent(e)},t.prototype.logArchivePreviewEvent=function(e,t){void 0===t&&(t={}),l.filePreviewEventEmitter.emit(e,this.props.filePreviewSession,t)},t.prototype.logUserAction=function(e,t,r){a.logUserAction(t,r,{isDir:e.isDir,extension:e.isDir?"":n.getWhitelistedExtension(e.name)})},t.prototype.markWebTiming=function(){this.props.filePreviewSession&&this.props.filePreviewSession.markPrimaryEvent(),h.mark_time_to_view(),h.mark_time_to_interactive()},t.prototype.render=function(){return i.default.createElement("div",null,i.default.createElement(v.View,{entry:this.props.entry,fileExtension:u.getExtension(this.props.rootFile),isPasswordProtected:this.props.isPasswordProtected,onEntryRowClick:this.handleEntryRowClick,rootFile:this.props.rootFile,currentSubpath:this.props.fileSubpath,encryptionOptions:this.props.encryptionOptions,user:this.props.user,sharePermission:this.props.sharePermission}),i.default.createElement(p.ArchiveEntryWatcher,{rootFile:this.props.rootFile,fileSubpath:this.props.fileSubpath,sharedLinkUrl:this.props.sharedLinkUrl,user:this.props.user}),i.default.createElement(f.ArchiveKeyboardBindingConnector,{fileSubpath:this.props.fileSubpath}))},t})(i.default.Component);t.App=w})),define("modules/clean/react/previews/archive/archive_entry_watcher",["require","exports","tslib","react","react-redux","modules/clean/react/previews/archive/data/actions","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils"],(function(e,t,r,i,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fetchArchiveFiles=function(e){var r=t.props;(0,r.fetchArchiveFiles)({rootFile:r.rootFile,subpathInfos:e,sharedLinkUrl:r.sharedLinkUrl,user:r.user})},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){var e=this.props.neededSubpathInfos;e.length&&this.fetchArchiveFiles(e)},t.prototype.render=function(){return null},t})((i=r.__importDefault(i)).default.Component);t.UnconnectedArchiveEntryWatcher=l;var c=a.makeGetArchiveEntry();var u={fetchArchiveFiles:o.fetchArchiveFiles};t.ArchiveEntryWatcher=n.connect((function(e,t){var r=t.rootFile,i=t.fileSubpath,n=c(e,{fileSubpath:i,rootFile:r});return{neededSubpathInfos:s.getNeededArchiveFileSubpathInfos(i,n).filter((function(t){return a.getShouldFetchArchiveFiles(e,{subpath:t.subpath})}))}}),u)(l)})),define("modules/clean/react/previews/archive/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_NUM_ROWS=10,t.MAX_ROW_WIDTH_IN_EMS=17,t.COMPRESSED_EXTENSIONS=["bz","bz2","gz","lz","lzma","xz","z"],t.COMPRESSED_CONTAINER_EXTENSIONS=["tar","xar"]})),define("modules/clean/react/previews/archive/data/actions",["require","exports","tslib","external/lodash","modules/clean/react/previews/archive/api","modules/clean/previews/data/actions"],(function(e,t,r,i,n,o){"use strict";var a;function s(){return{type:a.GetTreeApiFetch}}function l(e){var t=e.entry,r=e.isPasswordProtected;return{type:a.GetTreeApiSuccess,payload:{entry:t,isPasswordProtected:r}}}function c(e){return{type:a.GetTreeApiError,payload:{error:e}}}function u(e){var t=e.subpaths;return{type:a.GetArchiveFilesApiFetch,meta:{subpaths:t}}}function d(e){return{type:a.GetArchiveFilesApiSuccess,payload:{archiveFiles:e}}}function p(e,t){var r=t.subpaths;return{type:a.GetArchiveFilesApiError,meta:{subpaths:r},error:e}}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),(function(e){e.ResetState="ArchivePreviewResetState",e.GetTreeApiFetch="ArchivePreviewGetTreeApiFetch",e.GetTreeApiSuccess="ArchivePreviewGetTreeApiSuccess",e.GetTreeApiError="ArchivePreviewGetTreeApiError",e.GetArchiveFilesApiFetch="ArchivePreviewGetArchiveFilesApiFetch",e.GetArchiveFilesApiSuccess="ArchivePreviewGetArchiveFilesApiSuccess",e.GetArchiveFilesApiError="ArchivePreviewGetArchiveFilesApiError"})(a=t.Actions||(t.Actions={})),t.getTreeApiFetch=s,t.getTreeApiSuccess=l,t.getTreeApiError=c,t.getArchiveFilesApiFetch=u,t.getArchiveFilesApiSuccess=d,t.getArchiveFilesApiError=p,t.resetState=function(){return{type:a.ResetState}},t.fetchRootArchiveEntry=function(e){return function(t){t(s()),n.fetchRootArchiveEntry(e).then((function(e){var r=e.rootEntry,i=e.isPasswordProtected;t(l({entry:r,isPasswordProtected:i}))})).catch((function(e){t(c(e))}))}},t.fetchArchiveFiles=function(e){var t=e.rootFile,r=e.sharedLinkUrl,a=e.subpathInfos,s=e.user,l=a.map((function(e){return e.subpath}));return function(e){return e(u({subpaths:l})),n.fetchArchiveFiles({rootFile:t,sharedLinkUrl:r,subpathInfos:a,user:s}).then((function(r){return e(d(r)),e(o.populateArchivePreviews(t,i.values(r))),r})).catch((function(t){return e(p(t,{subpaths:l})),t}))}}})),define("modules/clean/react/previews/archive/data/reducer",["require","exports","tslib","modules/clean/react/previews/archive/data/actions","modules/clean/redux/types"],(function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialState={archiveFiles:{},rootEntry:void 0,treeApiStatus:void 0,error:void 0},t.previewArchiveReducer=function(e,o){switch(void 0===e&&(e=t.initialState),o.type){case i.Actions.GetTreeApiFetch:return r.__assign(r.__assign({},e),{treeApiStatus:n.ApiClientStatus.Fetch});case i.Actions.GetTreeApiSuccess:return r.__assign(r.__assign({},e),{rootEntry:o.payload.entry,isPasswordProtected:o.payload.isPasswordProtected,treeApiStatus:n.ApiClientStatus.Success});case i.Actions.GetTreeApiError:return r.__assign(r.__assign({},e),{treeApiStatus:n.ApiClientStatus.Error,error:o.payload.error});case i.Actions.GetArchiveFilesApiFetch:return r.__assign(r.__assign({},e),{archiveFiles:r.__assign(r.__assign({},e.archiveFiles),o.meta.subpaths.reduce((function(e,t){return e[t]={archiveFile:void 0,apiStatus:n.ApiClientStatus.Fetch},e}),{}))});case i.Actions.GetArchiveFilesApiSuccess:for(var a=o.payload.archiveFiles,s={},l=0,c=Object.keys(a);l<c.length;l++){var u=c[l];s[u]={archiveFile:a[u],apiStatus:n.ApiClientStatus.Success}}return r.__assign(r.__assign({},e),{archiveFiles:r.__assign(r.__assign({},e.archiveFiles),s)});case i.Actions.GetArchiveFilesApiError:return r.__assign(r.__assign({},e),{archiveFiles:r.__assign({},o.meta.subpaths.reduce((function(e,t){return e[t]={archiveFile:void 0,apiStatus:n.ApiClientStatus.Error,error:o.error},e}),{}))});case i.Actions.ResetState:return t.initialState;default:return e}}})),define("modules/clean/react/previews/archive/data/selectors",["require","exports","tslib","external/lodash","reselect","modules/clean/react/previews/archive/data/utils","modules/clean/redux/types","modules/clean/redux/namespaces"],(function(e,t,r,i,n,o,a,s){"use strict";function l(e){return e[s.PREVIEW_ARCHIVE_NAMESPACE_KEY]}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.getEncryptedStatus=function(e){return l(e).isPasswordProtected};var c=function(e,t){var r=(function(e,t){var r=l(e).archiveFiles;if(r)return r[t]})(e,t.subpath);if(r)return r.apiStatus},u=function(e){return l(e).rootEntry},d=i.flow(l,(function(e){return i.get(e,"archiveFiles",{})}));function p(e,t,r){var i=r.fileSubpath,n=r.rootFile;if(!e)return e;var a=i?o.walkEntryTree(e,i):e;return o.getEntryWithArchiveFiles({subpath:i,rootFile:n,entry:a,archiveFilesMap:t})}t.makeGetArchiveEntry=function(){return n.createSelector([u,d,function(e,t){return t}],p)},t.getShouldFetchArchiveFiles=function(e,t){var r=t.subpath;if(!r)return!1;var i=c(e,{subpath:r});return!i||![a.ApiClientStatus.Fetch,a.ApiClientStatus.Error].includes(i)},t.isErrorStateForSubpath=function(e,t){var r=t.subpath;return!!r&&c(e,{subpath:r})===a.ApiClientStatus.Error},t.getTreeApiStatus=function(e){return l(e).treeApiStatus}})),define("modules/clean/react/previews/archive/data/store",["require","exports","modules/clean/react/previews/archive/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/store"],(function(e,t,r,i,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForPreviewArchive=function(){var e;return o||(o=n.getStoreAndRegisterReducers(((e={})[i.PREVIEW_ARCHIVE_NAMESPACE_KEY]=r.previewArchiveReducer,e))),o}})),define("modules/clean/react/previews/archive/data/utils",["require","exports","tslib","external/lodash","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/utils"],(function(e,t,r,i,n,o){"use strict";function a(e){var t=e.subpath,i=e.entry,n=e.rootFile,a=e.archiveFilesMap;if(i.isDir||!t)return i;var s=a[t]&&a[t].archiveFile;return r.__assign(r.__assign({},i),{file:o.createFileFromEntryAndApi(i,n,s)})}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.walkEntryTree=function(e,t){for(var r=t.substring(1).split("/"),i=e,o="";r.length;){var a=r.shift(),s=a?i.children[a]:void 0;if(!s)return o!==t&&n.updateFileSubpathQuery(o),i;i=s,o+="/"+a}return i},t.getEntryWithArchiveFiles=function(e){return e.entry.isDir?(o=(t=e).subpath,s=t.entry,l=t.rootFile,c=t.archiveFilesMap,u=i.mapValues(s.children,(function(e,t){return a({subpath:n.addToFileSubpath(o,t),entry:e,rootFile:l,archiveFilesMap:c})})),r.__assign(r.__assign({},s),{children:u})):a(e);var t,o,s,l,c,u}})),define("modules/clean/react/previews/archive/entry_row",["require","exports","tslib","react","spectrum/file_icon","spectrum/icon_content","spectrum/media_table","modules/clean/display_format","modules/clean/em_string","modules/clean/react/previews/archive/constants","modules/clean/react/previews/archive/utils","modules/clean/react/thumbnail"],(function(e,t,r,i,n,o,a,s,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.stopPropagation(),t.props.onClick&&t.props.onClick(e,t.props.entry)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.entry,n=t.shouldHideSize,o=t.topOffset;return this.props.onClick?i.default.createElement(a.CulledMediaRow,{topOffset:o,onClick:this.handleClick,doubleLine:!0},(function(t){var i=t.isHovered;return f({entry:r,highlight:i,onClick:e.handleClick,shouldHideSize:n})})):i.default.createElement(a.CulledMediaRow,{topOffset:o,doubleLine:!0},f({entry:r,shouldHideSize:n}))},t})((i=r.__importDefault(i)).default.Component);t.EntryRow=p;var f=function(e){var t=e.entry,r=e.onClick,n=e.highlight,o=e.shouldHideSize,u=l.Emstring.em_snippet(t.name,c.MAX_ROW_WIDTH_IN_EMS),d=[i.default.createElement(a.MediaCell,{key:"rowname",title:r?i.default.createElement("button",{className:"entry-row-button",onClick:r,"aria-label":t.name},u):u,icon:i.default.createElement(m,{displayName:t.name,file:t.file,isDir:t.isDir}),highlight:n})];return t.size&&!o&&d.push(i.default.createElement(a.MediaCell,{key:"rowsize",title:s.format_bytes(t.size)})),d},m=function(e){return e.isDir?i.default.createElement(o.IconContent,{name:"folder-small"}):e.file&&u.shouldAllowVisualFolderIcons()?i.default.createElement(d.ThumbnailIcon,{className:"entry-row-icon",file:e.file,alt:e.displayName}):i.default.createElement(n.FileIcon,{path:e.displayName})}})),define("modules/clean/react/previews/archive/file_entry_view",["require","exports","tslib","react","classnames","modules/clean/react/file_viewer/data/selectors","modules/clean/redux/types","modules/clean/react/previews/loading_indicator","modules/clean/react/file_viewer/file_preview","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/size_class","modules/clean/react/previews/constants","modules/clean/previews/constants","react-redux","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils","modules/clean/react/size_class/constants","modules/clean/previews/data/selectors"],(function(e,t,r,i,n,o,a,s,l,c,u,d,p,f,m,v,h,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),n=r.__importDefault(n),t.PreviewTypeWhitelist=[p.PreviewType.SsrDoc,p.PreviewType.Excel,p.PreviewType.HTML,p.PreviewType.Image,p.PreviewType.RawHTML],t._FileEntryView=function(e){var r=e.entry,n=e.extensionsEnabled,o=e.previewApiData,s=e.isErrorState,u=e.isFullscreen,p=e.isSidebarOpen,f=e.sidebar,m=e.sizeClass,_=e.rootFile,g=e.encryptionOptions,y=r.file,b=m!==h.SizeClass.Small,E={canCopyToDropboxRoles:[],canDownloadRoles:[],canPrintRoles:[],canRemoveLinkUids:[],canSyncToDropboxRoles:[],canViewContextMenuRoles:[],canViewMetadataRoles:[]};return y?i.default.createElement(l.FilePreviewWithLogging,{extensionsEnabled:n,file:y,isFullscreen:u,isSidebarOpen:p,sidebar:f,sourceAction:d.PreviewSourceAction.Click,sourceContext:d.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[m],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:E,shouldDisplayToolbar:b,previewApiData:o,sizeClass:m,encryptionOptions:g}):s?i.default.createElement(l.FilePreview,{extensionsEnabled:n,file:v.createFileFromEntry(r,_),previewApiData:{data:void 0,status:a.ApiClientStatus.Error},isFullscreen:u,isSidebarOpen:p,sidebar:f,sourceAction:d.PreviewSourceAction.Click,sourceContext:d.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[m],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:E,shouldDisplayToolbar:b,sizeClass:m,encryptionOptions:g}):i.default.createElement(w,null)};var g=u.withSizeClass(t._FileEntryView,{responsiveClassName:"preview-content--full-height"});t.FileEntryView=f.connect((function(e,t){return{previewApiData:_.getPreviewForArchiveFile(e,t.entry.file),extensionsEnabled:o.getExtensionsEnabled(e),isFullscreen:o.getIsFullScreen(e),isSidebarOpen:o.getIsSidebarOpen(e),isErrorState:m.isErrorStateForSubpath(e,{subpath:t.currentSubpath}),sidebar:o.getSidebar(e)}}))(g);var w=function(){return i.default.createElement("div",{className:n.default("preview-content","preview-content--center","preview-content--full-height")},i.default.createElement(s.LoadingIndicator,null))}})),define("modules/clean/react/previews/archive/folder_entry_view",["require","exports","tslib","react","classnames","external/lodash","spectrum/icon_content","spectrum/dimensions","spectrum/table","modules/clean/react/previews/archive/entry_row","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/core/i18n","dig-components/buttons","modules/clean/react/file_viewer/file_conversion/decompress","modules/clean/react/file_viewer/file_conversion/utils"],(function(e,t,r,i,n,o,a,s,l,c,u,d,p,f,m,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),n=r.__importDefault(n),o=r.__importStar(o),t.FolderEntryView=function(e){var t=e.entry,n=e.onEntryRowClick,a=e.shouldAllowFileNavigation,s=e.file,l=e.user,c=e.sharePermission,u=i.useState(!1),d=u[0],h=u[1],w=o.values(t.children),y=w.length?i.default.createElement(_,{entries:w,onRowClick:n,shouldAllowFileNavigation:a}):i.default.createElement(g,null);return i.default.createElement(i.default.Fragment,null,l&&v.canExtractFile(s,c)&&i.default.createElement(f.Button,{className:"decompress-button",variant:"outline",onClick:function(){return(function(e,t){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return h(!0),[4,m.decompressFile(e,t)];case 1:return r.sent(),h(!1),[2]}}))}))})(s,l)},disabled:d},p.intl.formatMessage({id:"JlF6JV",defaultMessage:"Extract all"})),y)};var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderEntryRow=function(e,r,n){var o=t.props.shouldAllowFileNavigation||e.isDir?t.props.onRowClick:void 0;return i.default.createElement(c.EntryRow,{entry:e,onClick:o,shouldHideSize:t.props.sizeClass===d.SizeClass.Small,topOffset:n})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this;return i.default.createElement(s.Dimensions,{className:"preview-archive__table"},(function(t){t.width;var r=t.height;return i.default.createElement(l.Table,null,i.default.createElement(l.FixedTableHead,null,i.default.createElement(l.TableHeadCell,null,p.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"})),e.props.sizeClass===d.SizeClass.Small?null:i.default.createElement(l.TableHeadCell,null,p.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}))),i.default.createElement(l.CulledTableBody,{items:e.props.entries,listItemHeight:72,renderRow:e.renderEntryRow,viewportHeight:r,shouldUseWindowAsScrollContainer:!1}))}))},t})(i.default.Component),_=u.withSizeClass(h,{responsiveClassName:"preview-content--full-height"}),g=function(){return i.default.createElement("div",{className:n.default("preview-content","preview-content--center","preview-content--column","preview-content--full-height","preview-archive--empty")},i.default.createElement(a.IconContent,{name:"folder-small"}),i.default.createElement("div",{className:"empty-text u-pad-top-s"},p.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"})))}})),define("modules/clean/react/previews/archive/keyboard_binding_connector",["require","exports","tslib","react","modules/clean/keycode","modules/clean/react/file_viewer/location_utils","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/keyboard_binding/keyboard_binding_connector"],(function(e,t,r,i,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleKeyPress=function(){var e=o.shortenFileSubpathBy(t.props.fileSubpath,1);return o.updateFileSubpathQuery(e),!0},t.keyboardBindings=[{keyboardEventCriteria:a.generateUnmodifiedKeyboardEventCriteria(n.KeyCode.ESC),callback:t.handleKeyPress}],t}return r.__extends(t,e),t.prototype.render=function(){return i.default.createElement(s.KeyboardBindingConnector,{keyboardBindings:this.keyboardBindings})},t})((i=r.__importDefault(i)).default.Component);t.ArchiveKeyboardBindingConnector=l})),define("modules/clean/react/previews/archive/preview_archive",["require","exports","tslib","react","react-redux","modules/clean/react/previews/archive/app","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/data/store","modules/clean/react/previews/archive/data/actions","modules/clean/react/css"],(function(e,t,r,i,n,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i);var u=a.makeGetArchiveEntry();var d={fetchRootArchiveEntry:l.fetchRootArchiveEntry,resetState:l.resetState},p=n.connect((function(e,t){return{entry:u(e,{fileSubpath:t.fileSubpath,rootFile:t.rootFile}),isPasswordProtected:a.getEncryptedStatus(e),treeApiStatus:a.getTreeApiStatus(e)}}),d)(o.App);t.PreviewArchiveForTesting=p;var f=s.getStoreForPreviewArchive(),m=c.requireCssWithComponent((function(e){return i.default.createElement(n.Provider,{store:f},i.default.createElement(p,r.__assign({},e)))}),["/static/css/preview_archive-vflWyumo_.css"]);t.PreviewArchive=m})),define("modules/clean/react/previews/archive/utils",["require","exports","tslib","external/lodash","modules/clean/react/file_viewer/location_utils","modules/clean/previews/util","modules/core/uri"],(function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.getPreviewUrl=function(e){var t=a.URI.parse(e.toString()).toString();return"//"===t.slice(0,2)&&(t="https:"+t),t},t.shouldAllowVisualFolderIcons=function(){return!1},t.scanEntryContents=function(e){for(var t={},r=[e];r.length;){var n=r.shift();if(n.isDir)r.push.apply(r,i.values(n.children));else{var a=o.getWhitelistedExtension(n.name);t[a]=++t[a]||1}}return t},t.createFileFromEntry=function(e,t){return{subpath:e.name,is_dir:!1,filename:e.name,ns_id:t.ns_id,sjid:t.sjid,bytes:e.size,sort_key:void 0,href:void 0,ts:void 0,file_id:void 0,revision_id:void 0,is_symlink:!1}},t.createFileFromEntryAndApi=function(e,t,r){if(r)return{bytes:e.size,file_id:void 0,filename:r.filename,href:void 0,is_dir:!1,ns_id:t.ns_id,revision_id:void 0,sjid:t.sjid,sort_key:void 0,subpath:r.subpath,thumbnail_url_tmpl:r.thumbnail_url_tmpl,ts:void 0,is_symlink:!1,preview:r.preview}},t.getNeededArchiveFileSubpathInfos=function(e,t){return t?t.isDir||t.file||!e?i.values(t.children).filter((function(e){return!e.isDir&&!e.file})).map((function(t){return{subpath:n.addToFileSubpath(e,t.name),size:t.size}})):[{subpath:e,size:t.size}]:[]}})),define("modules/clean/react/previews/archive/view",["require","exports","tslib","react","spectrum/media_table_skeleton","spectrum/snackbar","modules/clean/react/async/loadable","modules/clean/react/previews/archive/folder_entry_view","modules/clean/react/previews/archive/constants","modules/core/i18n"],(function(e,t,r,i,n,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i);var u=a.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/previews/archive/file_entry_view"],t,r)})).then(r.__importStar).then((function(e){return e.FileEntryView}))}});t.View=function(e){var t=e.entry,r=e.rootFile,n=e.fileExtension,a=e.isPasswordProtected,s=e.onEntryRowClick,l=e.currentSubpath,u=e.encryptionOptions,f=e.user,m=e.sharePermission;return i.default.createElement("div",{className:"preview-archive"},i.default.createElement("div",{className:"preview-archive__content"},t?i.default.createElement(d,{entry:t,rootFile:r,shouldAllowFileNavigation:!a,onEntryRowClick:s,currentSubpath:l,encryptionOptions:u,user:f,sharePermission:m}):i.default.createElement(p,null),a?i.default.createElement(o.Snackbar,{title:c.intl.formatMessage({id:"xONQyk",defaultMessage:"Can’t preview items in password-protected {extension} files."},{extension:"."+n}),variant:"warn"}):null))};var d=function(e){return e.entry.isDir?i.default.createElement(s.FolderEntryView,{entry:e.entry,onEntryRowClick:e.onEntryRowClick,shouldAllowFileNavigation:e.shouldAllowFileNavigation,file:e.rootFile,user:e.user,sharePermission:e.sharePermission}):i.default.createElement(u,{entry:e.entry,rootFile:e.rootFile,currentSubpath:e.currentSubpath,encryptionOptions:e.encryptionOptions})},p=function(){return i.default.createElement("div",{className:"preview-archive__table"},i.default.createElement(n.MediaTableSkeleton,{numRows:l.DEFAULT_NUM_ROWS}))}})),define("modules/clean/react/copy_to_dropbox/actions",["require","exports","tslib","modules/clean/react/copy_to_dropbox/api","modules/core/browser"],(function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),n=r.__importStar(n),t.copySharedFile=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,i.copySharedFile(e,t)];case 1:return o=r.sent(),n.redirect(o),[2]}}))}))}})),define("modules/clean/react/copy_to_dropbox/api",["require","exports","tslib","modules/clean/ajax_as_promised"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.copySharedFile=function(e,t){var r={link_key:e.linkKey,link_type:e.linkType,secure_hash:e.secureHash,subpath:e.subPath};return e.itemId&&(r.item_id=e.itemId),new Promise((function(e,n){return i.WebProgressRequest({url:"/sm/c2d",data:r,subject_user:t,success:e})}))}})),define("modules/clean/react/copy_to_dropbox/modal",["require","exports","tslib","react","modules/clean/analytics","modules/clean/em_string","modules/clean/filepath","modules/clean/react/copy_to_dropbox/actions","modules/clean/react/modal","modules/clean/share_download/types","modules/clean/share_download/utils","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/logging"],(function(e,t,r,i,n,o,a,s,l,c,u,d,p,f,m,v,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),a=r.__importStar(a);var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAccept=function(){var e=g(t.props.role);f.Notify.success(e),s.copySharedFile(t.props.shareToken,t.props.userId),t.props.folderPreviewSession?m.logEvent(v.UserAction.SaveToDropboxApprove,t.props.folderPreviewSession):h.logUserAction(v.UserAction.SaveToDropboxApprove,v.UserActionContext.Unknown)},t.handleDismiss=function(e){t.props.onDismiss&&t.props.onDismiss(e),t.props.folderPreviewSession?m.logEvent(v.UserAction.SaveToDropboxCancel,t.props.folderPreviewSession):h.logUserAction(v.UserAction.SaveToDropboxCancel,v.UserActionContext.Unknown)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){n.WebMiscActivityLogger.log("show-c2d-modal")},t.prototype.render=function(){var e=this.props,t=e.copyable,r=e.role,n=u.getCopyableName(t),s=u.getCopyableType(t);return i.default.createElement(l.Modal,{title:w(n,r),acceptButtonText:p.intl.formatMessage({id:"78AHo5",defaultMessage:"Save"}),dismissButtonText:p.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onAccept:this.handleAccept,onDismiss:this.handleDismiss,style:"default-maestro"},i.default.createElement("p",{className:"db-modal-message"},(function(e,t,r){var n=d.Viewer.get_viewer(),s=n.get_user_by_role(t);if(e=o.Emstring.em_snippet(e,15),s&&s.is_cdm_member)return p.intl.formatMessage({id:"3Sb6Ws",defaultMessage:"<strong>{name}</strong> will be saved to the <strong>{cdm_tmf_name}</strong> folder in your {team_name} Dropbox account."},{name:e,cdm_tmf_name:a.filename(s.cdm_tmf_path),team_name:n.team_name,strong:function(e){return i.default.createElement("strong",null,e)}});if(n.is_paired)switch(t){case"personal":return p.intl.formatMessage({id:"nBgj3Q",defaultMessage:"<strong>{name}</strong> will be saved to your personal Dropbox account and synced to any connected devices."},{name:e,strong:function(e){return i.default.createElement("strong",null,e)}});case"work":switch(r){case c.CopyableType.Collection:return p.intl.formatMessage({id:"2yp43H",defaultMessage:"This album will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:n.team_name});case c.CopyableType.Folder:return p.intl.formatMessage({id:"eJs/IE",defaultMessage:"This folder will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:n.team_name});default:return p.intl.formatMessage({id:"Kb1en/",defaultMessage:"This file will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:n.team_name})}}switch(r){case c.CopyableType.Collection:return p.intl.formatMessage({id:"35MZFn",defaultMessage:"This album will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."});case c.CopyableType.Folder:return p.intl.formatMessage({id:"qkudum",defaultMessage:"This folder will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."});default:return p.intl.formatMessage({id:"uGDUlE",defaultMessage:"This file will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."})}})(n,r,s)))},t})(i.default.Component);function g(e){var t=d.Viewer.get_viewer();if(t.is_paired)switch(e){case"personal":return p.intl.formatMessage({id:"9Q/1TS",defaultMessage:"Saving to your personal Dropbox..."});case"work":return p.intl.formatMessage({id:"5wQTp4",defaultMessage:"Saving to your {team_name} Dropbox..."},{team_name:t.team_name})}return p.intl.formatMessage({id:"vFhcfF",defaultMessage:"Saving to your Dropbox..."})}function w(e,t){var r=d.Viewer.get_viewer(),i=r.get_user_by_role(t);if(i&&i.is_cdm_member)return p.intl.formatMessage({id:"yHgTUN",defaultMessage:"Save to your member folder?"});if(r.is_paired)switch(t){case"personal":return p.intl.formatMessage({id:"fI7sAv",defaultMessage:"Save to your personal Dropbox account?"});case"work":var n=r.team_name,a=new o.Emstring(n||"").length,s=Math.max(10,15-a);return p.intl.formatMessage({id:"5SXeZ6",defaultMessage:"Save ‘{name}’ to my {team_name} Dropbox"},{name:o.Emstring.em_snippet(e,s),team_name:n})}return p.intl.formatMessage({id:"ktpG9L",defaultMessage:"Save ‘{name}’ to my Dropbox"},{name:o.Emstring.em_snippet(e,15)})}t.CopyToDropboxModal=_})),define("modules/clean/react/share_download/actions",["require","exports","tslib","react","modules/clean/auth/login_or_register/types","modules/clean/downloads","modules/clean/react/copy_to_dropbox/modal","modules/clean/react/modal","modules/clean/react/share_download/api","modules/clean/storage","modules/clean/viewer","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify","modules/clean/react/share_download/api"],(function(e,t,r,i,n,o,a,s,l,c,u,d,p,f,m,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),o=r.__importStar(o),l=r.__importStar(l),d=r.__importStar(d),t.direct=function(e,i,n){return r.__awaiter(this,void 0,void 0,(function(){var a,s,c;return r.__generator(this,(function(r){switch(r.label){case 0:return a=e.downloadTestUrl,s=e.url,n||p.reportException({err:new Error("No encryption options provided for direct download action"),severity:"non-critical",tags:["sharing-encryption-options"]}),[4,t.authModalHelpers.authenticateForDownload(i||null,n)];case 1:if(r.sent(),!a)return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,l.testDownload(a)];case 3:return r.sent(),[3,5];case 4:return r.sent()instanceof v.TooLargeError?m.Notify.error(f.intl.formatMessage({id:"pcsTpL",defaultMessage:"The zip file is too large."})):m.Notify.error(f.intl.formatMessage({id:"pllUQE",defaultMessage:"Failed to download zip file."})),[2];case 5:return r.trys.push([5,7,,8]),[4,l.fetchDownloadUrl(s)];case 6:return c=r.sent(),o.get({url:c}),[3,8];case 7:return r.sent(),m.Notify.error(f.intl.formatMessage({id:"6OUwIN",defaultMessage:"Failed to download."})),[3,8];case 8:return[2]}}))}))},t.toDropbox=function(e,n,o,l,c,f){return r.__awaiter(this,void 0,void 0,(function(){var m,v;return r.__generator(this,(function(r){switch(r.label){case 0:return"anonymous"!==o?[3,2]:(c||p.reportException({err:new Error("No encryption options provided for anonymous sharing action"),severity:"non-critical",tags:["sharing-encryption-options"]}),[4,t.authModalHelpers.authenticateForSaveToDropbox(c)]);case 1:return m=r.sent(),v=d.reload,[3,4];case 2:return m=l?l.id:-1,p.assert(-1!==m,"role isn't anonymous => user cannot be null or undefined!"),u.Viewer.get_viewer().is_user_signed_in(l)?[3,4]:(c||p.reportException({err:new Error("No encryption options provided for multiaccount sharing action"),severity:"non-critical",tags:["sharing-encryption-options"]}),[4,t.authModalHelpers.doMultiAccountAuthentication(o,c)]);case 3:r.sent(),r.label=4;case 4:return s.Modal.showInstance(i.default.createElement(a.CopyToDropboxModal,{shareToken:e,copyable:n,userId:m,role:o,onDismiss:v,folderPreviewSession:f})),[2]}}))}))},t.authModalHelpers={authenticateForDownload:function(t,o){return t!==n.LoginOrRegisterKind.DOWNLOAD||c.LocalStorage.get("has_seen_download_signup_modal")?Promise.resolve():new Promise((function(a,l){var u=function(){c.LocalStorage.set("has_seen_download_signup_modal",!0),a()},d=function(){c.LocalStorage.set("has_seen_download_signup_modal",!0),l()};new Promise((function(t,r){e(["modules/clean/auth/login_or_register/modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.LoginOrRegisterModal;s.Modal.showInstance(i.default.createElement(r,{downloadAction:n.DownloadAction.DIRECT_DOWNLOAD,id:"shared-link-download-signup-modal",initialMode:n.Mode.REGISTER,kind:t,onAuthenticateSuccess:u,onCancel:d,signup_tag:"shmodel_download_register",encryptionOptions:o}))}))}))},authenticateForSaveToDropbox:function(t){return new Promise((function(o,a){var l=function(e){return o(e.id)};new Promise((function(t,r){e(["modules/clean/auth/login_or_register/modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.LoginOrRegisterModal;s.Modal.showInstance(i.default.createElement(r,{downloadAction:n.DownloadAction.SAVE_TO_DROPBOX,id:"shared-link-immediate-signup-modal",initialMode:n.Mode.REGISTER,kind:n.LoginOrRegisterKind.DOWNLOAD,onAuthenticateSuccess:l,onCancel:a,signup_tag:"shmodel_modal_register",encryptionOptions:t}))}))}))},doMultiAccountAuthentication:function(t,n){return new Promise((function(o,a){new Promise((function(t,r){e(["modules/clean/auth/multi_account_login_modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.MultiAccountLoginModal;s.Modal.showInstance(i.default.createElement(r,{onAuthenticateSuccess:o,onCancel:a,role:t,encryptionOptions:n}))}))}))}}})),define("modules/clean/react/share_download/models",["require","exports","tslib","immutable","react","modules/clean/filepath","modules/clean/react/file_viewer/constants","modules/clean/react/share_download/actions","modules/core/i18n","modules/core/exception","modules/clean/react/file_viewer/file_conversion/decompress"],(function(e,t,r,i,n,o,a,s,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),n=r.__importDefault(n),o=r.__importStar(o),s=r.__importStar(s);var d={text:void 0,handler:void 0,spriteName:void 0,isDisabled:void 0,userAction:void 0},p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.buildDirectOption=function(e,i,n){var o=this;return n||c.reportException({err:new Error("No encryption options for building direct download option"),severity:"non-critical",tags:["sharing-encryption-options"]}),new t({text:l.intl.formatMessage({id:"n1Nx/q",defaultMessage:"Direct download"}),handler:function(){return r.__awaiter(o,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.direct(e,i,n)];case 1:return t.sent(),[2]}}))}))},spriteName:"download_arrow",userAction:a.UserAction.Download})},t.buildToDropboxOption=function(e,r,i,u,d,p,f,m){void 0===p&&(p=!1),f||c.reportException({err:new Error("No encryption options for building to dropbox option"),severity:"non-critical",tags:["sharing-encryption-options"]});var v=l.intl.formatMessage({id:"l/lvUk",defaultMessage:"Save to my Dropbox"}),h="dropbox",_=a.UserAction.SaveToDropbox;if(u&&u.is_cdm_member){var g=o.filename(u.cdm_tmf_path);v=g.length>12?l.intl.formatMessage({id:"QPvsZL",defaultMessage:"Save to my member folder"}):l.intl.formatMessage({id:"VIDWC/",defaultMessage:"Save to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:g,strong:function(e){return n.default.createElement("strong",null,e)}}),i.is_paired&&(h="s_briefcase",_=a.UserAction.SaveToDropboxWork)}else if(i.is_paired)switch(d){case"personal":v=l.intl.formatMessage({id:"S5UJEB",defaultMessage:"Save to personal Dropbox"}),h="s_house",_=a.UserAction.SaveToDropboxPersonal;break;case"work":v=l.intl.formatMessage({id:"76AF1h",defaultMessage:"Save to {team_name} Dropbox"},{team_name:i.team_name}),h="s_briefcase",_=a.UserAction.SaveToDropboxWork}return new t({text:v,handler:function(){s.toDropbox(e,r,d,u,f,m)},spriteName:h,isDisabled:p,userAction:_,role:d})},t.extractToDropboxOption=function(e,r,i,n){void 0===n&&(n=!1);var s=l.intl.formatMessage({id:"IoJAyh",defaultMessage:"Extract to my Dropbox"}),c=a.UserAction.DecompressFile;if(e&&e.is_cdm_member){var d=o.filename(e.cdm_tmf_path);s=d.length>12?l.intl.formatMessage({id:"eN3/4H",defaultMessage:"Extract to my member folder"}):l.intl.formatMessage({id:"J+cK0b",defaultMessage:"Extract to {cdm_tmf_name} folder"},{cdm_tmf_name:d})}return new t({text:s,handler:function(){return u.decompressFile(r,e)},spriteName:"dropbox",isDisabled:n,userAction:c,role:i})},t})(i.Record(d));t.ShareDownloadActionOption=p})),define("modules/clean/react/share_download/util",["require","exports","tslib","react","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/utils","modules/clean/react/share_download/models","modules/clean/react/title_bar/overflow_menu","modules/clean/share_download/types","modules/clean/shared_link/types","modules/clean/viewer","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/file_conversion/utils"],(function(e,t,r,i,n,o,a,s,l,c,u,d,p,f){"use strict";function m(e,t,r,i,n){var o=e.canCopyToDropboxRoles,a=[];if(o.length>0){var l=d.Viewer.get_viewer(),c=l.get_users(!0),u=function(e,c){var u=-1===o.indexOf(c);a.push(s.ShareDownloadActionOption.buildToDropboxOption(t,r,l,e,c,u,i,n))};c.forEach((function(e){u(e,e.role)})),o.indexOf("anonymous")>-1&&u(void 0,"anonymous")}return a}function v(e,t,r,i,n,o,a,l){var d=e.canDownloadRoles,p=s.ShareDownloadActionOption.buildDirectOption,v=[];return c.isPendingEntry(i)?v:(d.length>0&&v.push(p(t,n,o)),v.push.apply(v,m(e,r,i,o,l)),a&&c.isEntry(i)&&u.isEntrySharedFile(i)&&f.canExtractFile(i,e)&&v.push(s.ShareDownloadActionOption.extractToDropboxOption(a,i,a.role,!1)),v)}function h(e,t,r,i,n){return function(s){i&&i(),e.handler&&e.handler(),r?p.logEvent(e.userAction,r):o.logUserAction(e.userAction,a.getSplitButtonUserActionContext(t,n))}}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.getToDropboxOptions=m,t.getDownloadOptions=v,t.callOptionHandler=h,t.getDownloadOptionsAsPopoverOrMobileItems=function(e,t,r,o,a,s){return v(e,t,r,o,null,a,null,s).map((function(e){return i.default.createElement(l.PopoverOrMobileItem,{key:e.userAction,disabled:e.isDisabled,onSelect:h(e,n.SplitButtonActionLocation.Split,s)},e.text)}))},t.isDownloadAllowed=function(e){return e.canDownloadRoles.length>0}})),define("modules/clean/react/title_bar/overflow_menu",["require","exports","tslib","react","modules/core/browser_detection","modules/clean/react/title_bubble","modules/core/i18n","spectrum/overflow_button","spectrum/popover","spectrum/mobile_menu","modules/clean/react/file_viewer/constants","modules/clean/react/sticky_position"],(function(e,t,r,i,n,o,a,s,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e,t){return e&&e(t)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.children,r=e.contentWrapperClassName,s=e.hideOnDisabled,p=e.direction,m=(function(e){var t=Array.isArray(e)?e.filter((function(e){return!!e})):e;return null==e||Array.isArray(t)&&0===t.length})(t);if(m&&s)return null;if(n.is_mobile_or_tablet())return i.default.createElement(c.MobileMenu,{trigger:function(e){var t=e.openMobileMenu;return i.default.createElement(f,{disabled:m,onClick:t})}},t);var v=p===u.OverflowMenuDirection.ABOVE?"above":"below",h=p===u.OverflowMenuDirection.ABOVE?d.StickyPosition.TOP:d.StickyPosition.BOTTOM;return i.default.createElement(l.Popover,{className:"more-button-popover",onSelection:this.handlePopoverSelection},i.default.createElement(l.PopoverTrigger,{"aria-label":a.intl.formatMessage({id:"oeNPkV",defaultMessage:"More actions"}),disabled:m},i.default.createElement(o.TitleBubble,{content:a.intl.formatMessage({id:"S6stj+",defaultMessage:"More"}),distanceFromTarget:10,isTargetPositionFixed:!0,position:h},i.default.createElement(f,{disabled:m}))),i.default.createElement("div",{className:r},i.default.createElement(l.PopoverContent,{attachment:"right",position:v},t)))},t})((i=r.__importDefault(i)).default.Component);function f(e){var t=e.disabled,r=e.onClick;return i.default.createElement(s.OverflowButton,{"aria-label":a.intl.formatMessage({id:"S6stj+",defaultMessage:"More"}),className:"u-mar-left-xs more-button",disabled:!0===t,onClick:r,tagName:"span",variant:"borderless"})}t.OverflowMenu=p;var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSelect=function(e){n.is_mobile_or_tablet()&&e.preventDefault();var r=t.props.onSelect;return r&&r(e)},t}return r.__extends(t,e),t.prototype.render=function(){var e=n.is_mobile_or_tablet(),t=this.props,o=(t.onSelect,r.__rest(t,["onSelect"]));return e?i.default.createElement(c.MobileMenuItem,r.__assign({onSelect:this.onSelect},o)):i.default.createElement(l.PopoverContentItem,r.__assign({value:this.onSelect},o))},t})(i.default.Component);t.PopoverOrMobileItem=m})),define("modules/clean/share_download/types",["require","exports"],(function(e,t){"use strict";function r(e){return"ns_id"in e}Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.Collection=0]="Collection",e[e.File=1]="File",e[e.Folder=2]="Folder"})(t.CopyableType||(t.CopyableType={})),t.isEntry=r,t.isPendingEntry=function(e){return r(e)&&null==e.ns_id}})),define("modules/clean/share_download/utils",["require","exports","modules/clean/share_download/types"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCopyableName=function(e){return r.isEntry(e)?e.filename:e.name},t.getCopyableType=function(e){return r.isEntry(e)?e.is_dir?r.CopyableType.Folder:r.CopyableType.File:r.CopyableType.Collection}})),define("modules/clean/shared_link/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEntrySharedFile=function(e){return"sjid"in e}})),define("spectrum/mobile_menu",["require","exports","tslib","spectrum/mobile_menu/mobile_menu","spectrum/mobile_menu/mobile_menu_close_button","spectrum/mobile_menu/mobile_menu_content","spectrum/mobile_menu/mobile_menu_item"],(function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(i,t),r.__exportStar(n,t),r.__exportStar(o,t),r.__exportStar(a,t)}));
//# sourceMappingURL=pkg-file_viewer_archive.min.js-vflChr-uZ.map